# 技术决策记录 (ADR - Architecture Decision Records)

## 决策记录格式

每个技术决策按以下格式记录：

```
## ADR-{编号}: {决策标题}

**日期**: YYYY-MM-DD
**状态**: [提议/接受/废弃/替代]
**决策者**: {角色/团队}

### 背景
{决策背景和问题描述}

### 决策
{具体决策内容}

### 理由
{决策理由和考虑因素}

### 后果
{决策带来的影响和后果}

### 替代方案
{考虑过的其他方案}
```

---

## ADR-001: 采用 RIPER 方法论作为核心框架

**日期**: 2025-01-23  
**状态**: 接受  
**决策者**: 架构师团队

### 背景

需要为 AI 辅助开发建立标准化的方法论框架，确保开发过程的结构化和可重复性。

### 决策

采用 RIPER (Research → Innovate → Plan → Execute → Review) 作为核心方法论框架。

### 理由

1. **完整性**: 覆盖软件开发全生命周期
2. **灵活性**: 支持快速路径和标准路径切换
3. **可扩展性**: 易于集成新工具和角色
4. **AI 友好**: 适合 AI 助手的结构化思维

### 后果

- 正面: 提供清晰的工作流程，提高开发效率
- 负面: 需要团队学习新的方法论，初期可能有适应成本

### 替代方案

- 敏捷开发 (Scrum/Kanban)
- 瀑布模型
- DevOps 流程

---

## ADR-002: 实现智能路径选择机制

**日期**: 2025-01-23  
**状态**: 接受  
**决策者**: 架构师 + 开发者

### 背景

不同复杂度的任务需要不同的处理方式，需要智能判断和路径选择机制。

### 决策

实现快速路径（简单任务）和标准路径（复杂任务）的智能切换机制。

### 理由

1. **效率优化**: 简单任务避免过度流程化
2. **质量保证**: 复杂任务确保充分分析
3. **动态适应**: 支持执行过程中的路径切换
4. **资源优化**: 合理分配时间和精力

### 后果

- 正面: 提高整体执行效率，优化资源配置
- 负面: 增加系统复杂度，需要准确的复杂度评估

### 替代方案

- 统一使用标准路径
- 手动选择执行路径
- 基于时间的路径选择

---

## ADR-003: 建立四角色协作体系

**日期**: 2025-01-23  
**状态**: 接受  
**决策者**: 分析师 + 架构师

### 背景

软件开发需要多维度的专业能力，单一角色难以覆盖所有需求。

### 决策

建立分析师、架构师、开发者、测试者四大核心角色的协作体系。

### 理由

1. **专业分工**: 每个角色专注自己的专业领域
2. **协作机制**: 通过权重分配实现有效协作
3. **质量保证**: 多角色审查确保项目质量
4. **知识互补**: 不同角色的知识和经验互补

### 后果

- 正面: 提高项目质量，降低单点风险
- 负面: 增加协调成本，可能影响决策速度

### 替代方案

- 全栈工程师模式
- 传统分层角色体系
- 敏捷团队模式

---

## ADR-004: 集成 MCP 工具生态

**日期**: 2025-01-23  
**状态**: 接受  
**决策者**: 架构师 + 开发者

### 背景

需要增强 AI 助手的能力，支持更复杂的任务处理和决策支持。

### 决策

集成 MCP (Model Context Protocol) 工具生态，包括反馈、思考、专业角色等工具。

### 理由

1. **能力增强**: 扩展 AI 助手的专业能力
2. **标准化**: MCP 提供标准化的工具接口
3. **生态丰富**: 可以利用现有的工具生态
4. **优雅降级**: 工具不可用时有备选方案

### 后果

- 正面: 显著提升 AI 助手能力，支持复杂场景
- 负面: 增加系统依赖，需要处理工具故障

### 替代方案

- 自研专用工具
- 使用其他 AI 工具平台
- 纯基础能力实现

---

## ADR-005: 采用 Markdown 作为文档标准

**日期**: 2025-01-23  
**状态**: 接受  
**决策者**: 开发者 + 测试者

### 背景

需要统一的文档格式，确保文档的可读性、可维护性和版本控制友好性。

### 决策

采用 Markdown 作为所有项目文档的标准格式。

### 理由

1. **简洁性**: 语法简单，易于编写和阅读
2. **兼容性**: 广泛支持，可转换为多种格式
3. **版本控制**: 纯文本格式，Git 友好
4. **工具支持**: 丰富的编辑器和渲染工具

### 后果

- 正面: 统一文档标准，提高协作效率
- 负面: 复杂格式支持有限，学习成本

### 替代方案

- Word/Google Docs
- Wiki 系统
- 专用文档平台

---

## ADR-006: 角色配置策略调整

**日期**: 2025-01-23
**状态**: 接受
**决策者**: 产品经理 + 架构师

### 背景

用户反馈指出应该优先使用项目级别的角色而不是 PromptX 系统自带的角色，需要调整角色配置策略。

### 决策

采用分层角色配置策略：

1. 优先检查 pouch.json 中的项目级别角色
2. 如果不存在项目级别角色，使用 RIPER 内置四大核心角色
3. 不使用 PromptX 系统自带的通用角色

### 理由

1. **项目特定性**: 项目级别角色更符合具体项目需求
2. **避免通用化**: 系统自带角色过于通用，缺乏项目针对性
3. **保持一致性**: 与 RIPER 方法论的角色体系保持一致
4. **用户需求**: 响应用户明确的配置要求

### 后果

- 正面: 角色配置更加精准，符合项目特定需求
- 负面: 需要重新配置已激活的角色，增加配置复杂度

### 替代方案

- 继续使用 PromptX 系统角色
- 混合使用项目角色和系统角色
- 完全自定义角色体系

---

## 决策状态说明

- **提议**: 决策正在讨论中
- **接受**: 决策已被采纳并实施
- **废弃**: 决策已被放弃
- **替代**: 决策被新的决策替代

## 决策评审流程

1. **提出**: 任何团队成员可以提出技术决策
2. **讨论**: 相关角色参与讨论和评估
3. **决策**: 主导角色做出最终决策
4. **记录**: 按照 ADR 格式记录决策
5. **实施**: 按照决策内容执行
6. **评估**: 定期评估决策效果，必要时调整
